

# Xpectros

<style>.calendar,.date{flex-direction:column;display:flex}.calendar,.calendar *{box-sizing:border-box}.calendar,.date,.day,.events{display:flex}.calendar{gap:1rem;padding:1rem;width:800px;--accent-color:var(--lightSuc)}.day{padding:.75rem;border-radius:8px;background-color:#1e1e1e;box-shadow:0 0 4px rgba(0,0,0,.5);width:100%}.date{align-items:center;justify-content:center;margin-right:1rem;width:50px;color:var(--accent-color)}.number{font-size:1.5rem;font-weight:700}.month{font-size:.75rem;color:#ccc;margin-top:.2rem}.events{flex-direction:column;gap:.5rem;flex-grow:1}.event{background-color:#2c2c2c;padding:.5rem .75rem;border-radius:6px;color:#fff;border-left:4px solid var(--accent-color)}</style>
<div class="templates" style="display:none;"> <div class="event-template event">[name]</div> <div class="day-template day"> <div class="date"> <div class="number">[day]</div> <div class="month">[month]</div> </div> <div class="events"> </div> </div> </div> <div class="calendar" id="calendar"></div>
<script>const populateDays=e=>{let t=document.getElementById("calendar"),a=document.querySelector(".day-template"),n=document.querySelector(".event-template");Object.keys(e).sort().forEach(l=>{let r=a.cloneNode(!0);r.classList.remove("day-template"),r.querySelector(".number").textContent=l.slice(8,10),r.querySelector(".month").textContent=new Date(l).toLocaleString("default",{month:"short"});let o=r.querySelector(".events");e[l].forEach(e=>{let t=n.cloneNode(!0);t.classList.remove("event-template");let a=e.name;e.allDay||(a+=` (${e.startTime} - ${e.endTime})`),t.textContent=a,o.appendChild(t)}),t.appendChild(r)})},populateCalendar=e=>{fetch("https://n8n.floresbenavides.com/webhook/calendario").then(e=>e.json()).then(e=>{e.map(e=>{if(e.allDay=e.start.length<=10,e.allDay){let t=new Date(e.end);t.setDate(t.getDate()-1),e.end=t.toISOString().slice(0,10)}else{let a=new Date(e.start),n=new Date(e.end);e.startTime=a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),e.endTime=n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}return e});let t={};e.forEach(e=>{let a=e.start.slice(0,10);if(t[a]||(t[a]=[]),e.allDay){let n=new Date(e.start),l=new Date(e.end),r=l.getTime()-n.getTime(),o=Math.ceil(r/864e5)+1,i=1;for(let d=new Date(n);d<=l;d.setDate(d.getDate()+1)){let s=Object.assign({},e),c=d.toISOString().slice(0,10);t[c]||(t[c]=[]),s.name=1===o?s.name:`${s.name} (d\xeda ${i}/${o})`,t[c].push(s),i++}}else t[a].push(e)}),populateDays(t)}).catch(t=>{e.innerHTML="Error loading calendar data.",console.error("Error fetching calendar data:",t)})};document.addEventListener("DOMContentLoaded",function(){populateCalendar(document.getElementById("calendar"))});</script>
